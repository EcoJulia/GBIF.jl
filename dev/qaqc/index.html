<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Filtering records · GBIF wrapper in Julia</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>GBIF wrapper in Julia</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../data/">Getting data</a></li><li class="current"><a class="toctext" href>Filtering records</a><ul class="internal"><li><a class="toctext" href="#Apply-filters-to-the-data-1">Apply filters to the data</a></li><li><a class="toctext" href="#Removing-filters-1">Removing filters</a></li><li><a class="toctext" href="#List-of-built-in-filters-1">List of built-in filters</a></li><li><a class="toctext" href="#Making-your-own-filters-1">Making your own filters</a></li><li><a class="toctext" href="#Filtering-occurrences-after-download-1">Filtering occurrences after download</a></li></ul></li></ul></li><li><a class="toctext" href="../types/">Types</a></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Filtering records</a></li></ul><a class="edit-page" href="https://github.com/EcoJulia/GBIF.jl/blob/master/docs/src/qaqc.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Filtering records</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Filtering-observations-1" href="#Filtering-observations-1">Filtering observations</a></h1><p>Within a <code>GBIFRecord</code> object, the occurrences themselves are stored in a view. A view is basically an array that can be masked, so it is possible to retain all of the raw data, while only presenting the data that pass filtering.</p><h2><a class="nav-anchor" id="Apply-filters-to-the-data-1" href="#Apply-filters-to-the-data-1">Apply filters to the data</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.filter!" href="#Base.filter!"><code>Base.filter!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>Filters a series of records</strong></p><p>This function will take the filter function <code>f</code> and use it to <em>mask</em> the records that do not satisfy it. Note that if a record is <em>already</em> masked due to the application of a previous filter, its status will <em>not</em> be modified. The application of filters is therefore cumulative.</p><p>Note that while the usual <code>filter!</code> function <em>removes</em> objects, this one will only <em>mask</em> them. The objects can be unmasked with <code>allrecords!</code>. This design choice was made because <code>GBIFRecords</code> track the position in the API pages, and it seemed safer to keep all information. Note that when calling <code>length</code> or iterating over a <code>GBIFRecords</code> object, only the <em>unmasked</em> records will be shown.</p><p>It is possible to apply multiple filters at once, using the following syntax:</p><pre><code class="language-none">filter!.([f1, f2, f3], records)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L66-L85">source</a></section><h2><a class="nav-anchor" id="Removing-filters-1" href="#Removing-filters-1">Removing filters</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.allrecords!" href="#GBIF.allrecords!"><code>GBIF.allrecords!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>Show all occurrences</strong></p><p>This function reverses the action of <code>filter!</code>. It will unmask all records that have been removed under the current filters.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L129-L134">source</a></section><h2><a class="nav-anchor" id="List-of-built-in-filters-1" href="#List-of-built-in-filters-1">List of built-in filters</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.have_both_coordinates" href="#GBIF.have_both_coordinates"><code>GBIF.have_both_coordinates</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>Both latitude and longitude are present</strong></p><p>This filter will only retain occurrences that have <em>both</em> a latitude and a longitude field.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L1-L6">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.have_neither_zero_coordinates" href="#GBIF.have_neither_zero_coordinates"><code>GBIF.have_neither_zero_coordinates</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>Neither latitude nor longitude are 0.0</strong></p><p>This filter will only retain occurrences that are <em>not</em> at the (0,0) coordinate.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L11-L15">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.have_no_zero_coordinates" href="#GBIF.have_no_zero_coordinates"><code>GBIF.have_no_zero_coordinates</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>At most one of latitude and longitude is 0.0</strong></p><p>This filter will only retain occurrences that have <em>at most</em> one coordinate being exactly 0.0.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L20-L25">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.have_no_issues" href="#GBIF.have_no_issues"><code>GBIF.have_no_issues</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>No known issues at all</strong></p><p>This filter will retain no observation. At least not in theory, but it is very rare to have GBIF records with absolutely no issues. Its use is discouraged.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L39-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.have_ok_coordinates" href="#GBIF.have_ok_coordinates"><code>GBIF.have_ok_coordinates</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>No coordinates issues except rounding and WGS84 assumption</strong></p><p>This filter will retain observations that have no issues, with the exception of assuming WGS84 projection (which a large number of GBIF records do), and rounded coordinates (same thing). It is a reasonable filter for most use cases.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L49-L55">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GBIF.have_a_date" href="#GBIF.have_a_date"><code>GBIF.have_a_date</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><strong>The date is not missing</strong></p><p>This filter will remove observations with a missing date.</p></div></div><a class="source-link" target="_blank" href="https://github.com/EcoJulia/GBIF.jl/blob/dc0739748221c8646586f155f590dcaf205ff5e1/src/filter.jl#L30-L34">source</a></section><h2><a class="nav-anchor" id="Making-your-own-filters-1" href="#Making-your-own-filters-1">Making your own filters</a></h2><p>Filter functions are all sharing the same declaration: they accept a single <code>GBIFRecord</code> object as input, and return a boolean as output. Think of the filter as a question you ask about the occurrence object. Does it have no know issues? If this is <code>true</code>, then we keep this record. If not, we reject it.</p><h2><a class="nav-anchor" id="Filtering-occurrences-after-download-1" href="#Filtering-occurrences-after-download-1">Filtering occurrences after download</a></h2><p>The <code>GBIFRecords</code> objects can be used with the <code>Query.jl</code> package. For example, to get the observations from France in the most recent 20 observations, we can use:</p><pre><code class="language-julia">using Query
o = occurrences()
@from i in o begin
    @where i.country == &quot;France&quot;
    @select {i.key, i.species}
    @collect
end</code></pre><footer><hr/><a class="previous" href="../data/"><span class="direction">Previous</span><span class="title">Getting data</span></a><a class="next" href="../types/"><span class="direction">Next</span><span class="title">Types</span></a></footer></article></body></html>
